{
  "hash": "4c5fd2605cfbd9be316bf84918d9be77",
  "result": {
    "markdown": "---\ntitle: \"Wired for success WIP\"\ndraft: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Motivation\n\n1. Electrification is a cannonical example of a **General Purpose Technology (GPT)**\n\n2. When this new technology was adopted in Sweden:\n\n    - It made individuals richer ğŸ’°ğŸ”‹\n    - It lowered inequality ğŸ“‰ğŸ¤\n    - It allowed structural change on the labor market ğŸ”§ğŸ’¼\n\n\n2. What we want to know next:\n\n    - Who were the innovators or adopters? ğŸ¤”ğŸš€\n    - Did they move to opportunity? ğŸƒâ€â™€ï¸ğŸ’¼\n    - How much training did they have in the new technology? ğŸ“âš¡ï¸\n    \n\n## Who is who?\n\n:::: {.columns}\n\n::: {.column width=\"70%\"}\n\nVem Ã¤r Vem? is a **Swedish biographical encyclopedia** that was published in two editions of five volumes each in 1945â€“1950 and 1962â€“1968 by BokfÃ¶rlaget Vem Ã¤r Vem.\n\nThe intention was, according to the publishers, to draw attention **to people who were at the height of their activities**, even if they were younger, in influential or otherwise noted positions in different areas.\n\n- Biographies and career trajectories of ~ 69,448 individuals!\n\n- 8 of the 10 volumes are digitized by librarians in Uppsala â€“ thank you <3\n\n:::\n\n::: {.column width=\"5%\"}\n\n:::\n\n::: {.column width=\"25%\"}\n\n![](assets/vem_cover.png){fig-align=\"center\" width=100%}\n\n:::\n\n::::\n\n## Vem Ã¤r Vem? Example page\n\n![](assets/vem_page.png){fig-align=\"center\" width=100%}\n\n## Vem Ã¤r Vem?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Wired-for-success-WIP_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## Vem Ã¤r Vem? Example biography\n\n![](assets/Karl_Lund.png)\n\n## Vem Ã¤r Karl Lund? {visibility=\"uncounted\"}\n\nLund, Karl Gustaf, chief engineer, Varberg, born on July 22, 1893, in Hille, GÃ¤vle County, Sweden, son of factory worker Ferdinand L. and Maria Andersson. Married in 1936 to Sigrid Johansson. Children: Ingvar (born 1938), Lennart (born 1942). â€” Graduated from Bergsskolan in Filipstad in 1917, specialized studies at the Royal Institute of Technology (KTH) from 1920 to 1922, studied at the Institute of Metallurgy and Stockholm University in 1921-1922. Chemist at StrÃ¶msnÃ¤s JÃ¤rnverks A-B in Degerfors from 1918 to 1920, metallurgist and chemist at Westinghouse Electric & Manufacturing Co. in East Pittsburgh, PA, USA, from 1923 to 1926 and 1928 to 1929, chief metallurgist at Laclede Steel Co. in Alton, Illinois, USA, in 1927, furnace and steelworks engineer at A-B Iggesunds Bruk from 1929 to 1931, site manager at Gunnebo Bruks Nya A-B, Varbergsverket, since 1931. Member of the municipal executive committee, deputy chairman of the economic department, deputy member of the board of the power plant, chairman of Varbergs Sparbank, employer representative in the district council of the county labor board, member of the board of Varbergs LuftskyddsfÃ¶rening (Varberg Air Protection Association), secretary of Varbergs HÃ¶gerfÃ¶rening (Varberg Conservative Association), chairman of the railway sick fund, and Plant Society for Small Bird Friends. \n\n## Vem Ã¤r Karl Lund? {visibility=\"uncounted\"}\n\nTraveled to Germany in 1921, 1923, 1930, and 1936, Denmark, Czechoslovakia in 1921, 1922, and 1923, Austria in 1921, and the USA from 1923 to 1929. Writings: \"Some fundamental factors for obtaining sharp thermal curves\" (Transactions of the American Society for Steel Treating, co-authored with C. Benedicks and W. H. Dearden, 1925), \"Contemporary production of saw blades, circular saws, and machine knives\" (Timber Industry, 1931). Hobbies: hunting and fishing.\n\n## Vem Ã¤r Karl Lund?\n\n[Lund, Karl Gustaf]{style=\"background-color: #b0c4de\"}, [chief engineer]{style=\"background-color: #d2b48c\"}, [born on July 22, 1893]{style=\"background-color: #ff8c69\"}, [in Hille, GÃ¤vle County]{style=\"background-color: #90ee90\"}, Sweden, son of [factory worker Ferdinand L. and Maria Andersson]{style=\"background-color: #9370db\"}. Married in 1936 to [Sigrid Johansson]{style=\"background-color: #ffadc1\"}. Children: [Ingvar (born 1938)]{style=\"background-color: #ffdead\"}, [Lennart (born 1942)]{style=\"background-color: #ffdead\"}. â€” Graduated from [Bergsskolan]{style=\"background-color: #afeeee\"} in Filipstad in 1917, specialized studies at the [Royal Institute of Technology (KTH)]{style=\"background-color: #afeeee\"} from 1920 to 1922, studied at the [Institute of Metallurgy]{style=\"background-color: #afeeee\"} and [Stockholm University]{style=\"background-color: #afeeee\"} in 1921-1922. Chemist at [StrÃ¶msnÃ¤s JÃ¤rnverks A-B]{style=\"background-color: #98fb98\"} in Degerfors from 1918 to 1920, metallurgist and chemist at [Westinghouse Electric & Manufacturing Co.]{style=\"background-color: #98fb98\"} in East Pittsburgh, PA, USA, from 1923 to 1926 and 1928 to 1929, chief metallurgist at [Laclede Steel Co.]{style=\"background-color: #98fb98\"} in Alton, Illinois, USA, in 1927, furnace and steelworks engineer at [A-B Iggesunds Bruk]{style=\"background-color: #98fb98\"} from 1929 to 1931, site manager at [Gunnebo Bruks Nya A-B, Varbergsverket]{style=\"background-color: #98fb98\"}, since 1931. Member of the municipal executive committee, deputy chairman of the economic department, deputy member of the board of the power plant, chairman of [Varbergs Sparbank]{style=\"background-color: #ffdab9\"}, employer representative in the district council of the county labor board, member of the board of [Varbergs LuftskyddsfÃ¶rening (Varberg Air Protection Association)]{style=\"background-color: #ffdab9\"}, secretary of [Varbergs HÃ¶gerfÃ¶rening (Varberg Conservative Association)]{style=\"background-color: #ffdab9\"}, chairman of the railway sick fund, and [Plant Society for Small Bird Friends]{style=\"background-color: #ffdab9\"}. \n\n## Vem Ã¤r Karl Lund?\n\nTraveled to [Germany]{style=\"background-color: #e6e6fa\"} in 1921, 1923, 1930, and 1936, [Denmark]{style=\"background-color: #e6e6fa\"}, [Czechoslovakia]{style=\"background-color: #e6e6fa\"} in 1921, 1922, and 1923, [Austria]{style=\"background-color: #e6e6fa\"} in 1921, and the [USA]{style=\"background-color: #e6e6fa\"} from 1923 to 1929. Writings: \"Some fundamental factors for obtaining sharp thermal curves\" (Transactions of the American Society for Steel Treating, co-authored with C. Benedicks and W. H. Dearden, 1925), \"Contemporary production of saw blades, circular saws, and machine knives\" (Timber Industry, 1931). Hobbies: [hunting]{style=\"background-color: #ffd700\"} and [fishing]{style=\"background-color: #ffd700\"}.\n\n##\n\n![](assets/tidy.jpg)\n\n## Data pipeline\n\n<br>\n\n| Step | Process                                   |        | Description                                                           |\n|------|-------------------------------------------|-------------|\n| 1    | Scrape book data from website             | ğŸŒâ¡ï¸ğŸ“š       | \n| 2    | Split biographies on each page of a book  | ğŸ“šâ¡ï¸ğŸ“„       | \n| **3**    | **Translate biographies**                     | ğŸ“„ğŸ”„ğŸ“„       | \n| **4**    | **Structure biographies using Schema.org**    | ğŸ“„â¡ï¸ğŸ”—       | \n| **5**    | **Augment data**                              | ğŸ”—ğŸ”ğŸŒğŸ“ğŸ“š   |\n| 6    | Store data                                | ğŸ”—ğŸ“šğŸ“‚       | \n\n## NLP challenges\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n<br>\n\n- Many abbreviations and contractions\n    - DOB: \"f\\.\\\\s*(\\\\d{2})\\\\/(\\\\d{2})/(\\\\d{2})\"\n    - GÃ¤vleborg County: \"GÃ¤vleb. l.\"\n\n- Similar structure for each entry but not exactly the same information in the same order\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n<br>\n\n![](assets/Karl_Lund_crop.png){fig-align=\"center\"}\n\n:::\n\n::::\n\n## 1. Translate ğŸ¤–\n\n### Using OpenAI's GPT-3.5 chat API:\n\nWe tell the system \"You are an expert in Swedish family history\"\n\nThen we ask it to translate the Swedish text to English\n\n<br>\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndef translate_and_structure_text(swedish_text):\n    try:\n        # Translate the Swedish text to English\n        translate_prompt = f\"Translate the following abbreviated Swedish biography to English: {swedish_text}\"\n        translation_response = openai.ChatCompletion.create(\n            model=\"gpt-3.5-turbo\",\n            messages=[\n                {\"role\": \"system\", \"content\": \"You are an expert on Swedish family history.\"},\n                {\"role\": \"user\", \"content\": f\"{translate_prompt}\"}\n            ]\n        )\n```\n:::\n\n\n\n## 2. Structure ğŸ¤–\n\n![](assets/schema.png)\n\n## 2. Structure ğŸ¤–\n\n### Using OpenAI's GPT-3.5 chat API:\n\nWe tell the system \"You are an expert in Swedish family history and the Schema.org/Person format\" \n\nWe provide it the original Swedish and English translation, and ask it to structure the biography in Schema.org/Person format as a JSON object\n\n<br>\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nstructure_prompt = f\"Given the original Swedish biography: {swedish_text}\\nAnd its English translation: {english_text}, Structure the biography in Schema.org/Person format as a JSON object. Include dates wherever possible. Only provide a  RFC8259 compliant JSON response.\"\n\nstructure_response = openai.ChatCompletion.create(\n    model=\"gpt-3.5-turbo\",\n    messages=[\n        {\"role\": \"system\", \"content\": \"You are an expert on Swedish family history and the Schema.org/Person format.\"},\n        {\"role\": \"user\", \"content\": f\"{structure_prompt}\"}\n    ]\n)\n```\n:::\n\n\n## 3. Augment ğŸ¤–\n\n### Using OpenAI's GPT-4 chat API:\n\nWe create python code to geocode any addresses in the biography (in this example), as well as flagging the highest level of education, and extract any mention of patents or inventions in the biography.\n\n<br>\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndef geocode_birthplace(birthplace, geolocator, geocoded_cache):\n    if isinstance(birthplace, dict):\n        if \"name\" in birthplace:\n            birthplace_name = birthplace[\"name\"]\n        elif \"address\" in birthplace and \"addressLocality\" in birthplace[\"address\"]:\n            birthplace_name = birthplace[\"address\"][\"addressLocality\"]\n        else:\n            print(f\"Invalid birthplace data: {birthplace}\")\n            return None\n    elif isinstance(birthplace, str):\n        birthplace_name = birthplace\n    else:\n        print(f\"Invalid birthplace data: {birthplace}\")\n        return None\n\n    if birthplace_name not in geocoded_cache:\n        try:\n            location = geolocator.geocode(birthplace_name)\n            if location:\n                geocoded_cache[birthplace_name] = {\n                    \"latitude\": location.latitude,\n                    \"longitude\": location.longitude\n                }\n            time.sleep(1)  # Add a 1-second delay between geocoding requests\n        except Exception as e:\n            print(f\"Error geocoding birthplace {birthplace_name}: {e}\")\n\n    return geocoded_cache.get(birthplace_name)\n```\n:::\n\n\n\n## Output\n\n\n\n::: {.cell}\n\n```{.python .cell-code  code-line-numbers=\"6-14\"}\n{\n    \"original\": \"Lund, Karl Gustaf, Ã¶veringenjÃ¶r, Varberg, f. 22/7/93 i Hille, GÃ¤vleb. 1., av brukstj :m. Ferdinand L. o. Maria Andersson. G. 36 m. Sigrid Johansson. Barn: Ingvar f. 38, Lennart 42. â€” Ex. v. bergssk. i Filipstad 17, spec:-stud. v. KTH (B) 20-22, stud. v. me-tallogr. inst. o. Sthlms hÃ¶gsk. 21-22. Kemist v. StrÃ¶msnÃ¤s JÃ¤rnverks A-B, Degerfors, 18-20, metallurg o. kemist v. Westinghouse Electric & Manuf. Co., East Pittsburgh, Pa, USA, 23-26 o. 28-29, chefsmetallurg v. Laclede Steel^Co., Ahon, 111., USA, 27, hytt-o. stÃ¥lv.ing. v. A-B Iggesunds Bruk 29-31, platschef v. Gunnebo Bruks Nya A-B, Varbergsverket, sed. 31. Led. av drÃ¤tselkamm., v. ordf. v. ekonomi-avd., suppl. i styr. f. elverket, huv:-man i Varbergs Sparbank, arb :giv. repr. i lÃ¤nsarb:ndns kretsrÃ¥d, led. av styr. f. Varbergs luftsk ifÃ¶ren., sekr. i Varbergs hÃ¶gerfÃ¶ren., ordfs i jÃ¤rnv. sjukkassa o. Plant :sÃ¤llsk. SmÃ¥fÃ¥gl. VÃ¤nner. Res. t. Tyskl. 21, 2^ 23, 30 o. 36, Danm., Tjeckoslov. 21, 22, 23, Ã–sterr. 21, USA 23-29. Skr.: Some fundamental factors for obtaining sharp thermal curves (TrÃ¤ns. Am. Soc. for Steel Treating, tills. m. C. Benedicks o. W. H. Dearden 25), Nutida fabrikation av sÃ¥gblad, sÃ¥gklingor o. maskinknivar (TrÃ¤varuind. 31). Hob-bies: jakt o. fiske.\",\n    \"translated\": \"Lund, Karl Gustaf, chief engineer, Varberg, born on July 22, 1893, in Hille, GÃ¤vle County, Sweden, son of factory worker Ferdinand L. and Maria Andersson. Married in 1936 to Sigrid Johansson. Children: Ingvar (born 1938), Lennart (born 1942). â€” Graduated from Bergsskolan in Filipstad in 1917, specialized studies at the Royal Institute of Technology (KTH) from 1920 to 1922, studied at the Institute of Metallurgy and Stockholm University in 1921-1922. Chemist at StrÃ¶msnÃ¤s JÃ¤rnverks A-B in Degerfors from 1918 to 1920.\",\n    \"structured\": {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"Person\",\n        \"name\": \"Karl Gustaf Lund\",\n        \"birthDate\": \"1893-07-22\",\n        \"birthPlace\": {\n            \"name\": \"Hille, GÃ¤vle County, Sweden\",\n            \"latitude\": 59.916667,\n            \"longitude\": 15.0\n        },\n        \"jobTitle\": \"Chief Engineer\",\n        \"memberOf\": {\n            \"@type\": \"Organization\",\n            \"name\": \"Swedish Technical Association\"\n        },\n        \"children\": [\n            {\n                \"@type\": \"Person\",\n                \"name\": \"Anita\",\n                \"birthDate\": \"1937\"\n            },\n            {\n                \"@type\": \"Person\",\n                \"name\": \"Peter\",\n                \"birthDate\": \"1942\"\n            }\n        ],\n        \"spouse\": {\n            \"@type\": \"Person\",\n            \"name\": \"Marianne Hammarberg\",\n            \"marriageDate\": \"1936\"\n        },\n        \"education\": [\n            {\n                \"@type\": \"EducationalOccupationalCredential\",\n                \"credentialCategory\": \"Vocational\",\n                \"issuer\": {\n                    \"@type\": \"Organization\",\n                    \"name\": \"Technical Gymnasium in Ã–rebro\"\n                },\n                \"endDate\": \"1928\"\n            },\n            {\n                \"@type\": \"EducationalOccupationalCredential\",\n                \"credentialCategory\": \"Degree\",\n                \"issuer\": {\n                    \"@type\": \"Organization\",\n                    \"name\": \"KTH\"\n                },\n                \"endDate\": \"1934\"\n            }\n        ],\n        \"worksFor\": {\n            \"@type\": \"Organization\",\n            \"name\": \"Telegraph station in NorrkÃ¶ping\",\n            \"startDate\": \"1946\"\n        },\n        \"hasOccupation\": [\n            {\n                \"@type\": \"Occupation\",\n                \"name\": \"Engineering assistant\",\n                \"employer\": {\n                    \"@type\": \"Organization\",\n                    \"name\": \"Telegraph station in NÃ¤ssjÃ¶\"\n                },\n                \"startDate\": \"1935\",\n                \"endDate\": \"1935\"\n            },\n            {\n                \"@type\": \"Occupation\",\n                \"name\": \"Line engineer\",\n                \"employer\": {\n                    \"@type\": \"Organization\",\n                    \"name\": \"Telegraph station in NorrkÃ¶ping\"\n                },\n                \"startDate\": \"1946\"\n            }\n        ]\n    }\n}\n```\n:::\n\n\n## Output\n\n\n::: {.cell .column-page}\n::: {.cell-output-display}\n![](Wired-for-success-WIP_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Wired-for-success-WIP_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}