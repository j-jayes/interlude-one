{
  "hash": "290936dae42946eca21e7ca9bfd1203d",
  "result": {
    "markdown": "---\ntitle: \"Recreating Our World In Data’s Beautiful Transistor Count Graphic\"\ndescription: |\n  Scraping data from Wikipedia and recreating OWID's figure with ggplot2.\nauthor:\n  - name: Jonathan Jayes\nimage: figures/Transistors_colour.jpeg\ndate: 04-08-2020\noutput:\n  distill::distill_article:\n    self_contained: false\n    code_folding: false\n    highlight: haddock\n    highlight_downlit: true\n    toc: true\n---\n\n\n\n\n\n## Purpose\n\nIn this document I walk through the process to recreate a data visualization from Our World in Data. I use the web scraping package rvest to get the data from Wikipedia and some neat tidyverse tools.\n\nThe graphic depicts the metal–oxide–silicon (MOS) transistor count on commercially available microprocessors over time. This progression is known as Moore's law, which observed that the transistor count doubles approximately every two years.\n\n<center>\n\n![Graphic showing Moore's Law - Our World In Data](figures/Moore's_Law_Transistor_Count_1971-2018.png)\n\n</center>\n\nFirst, I show the wikipedia page that contains the information that I want to scrape (and contains the Our World in Data graphic).\n\n<center>\n\n![Wikipedia article](figures/transistor-count-wiki-page.png){#id .class width=50% height=50%}\n\n</center>\n\nThe Wikipedia article on transistor counts includes a table containing 193 microprocessors released between 1971 and 2020, shown below. Crucially, it specifies for each chip the release year and transistor count.\n\n<center>\n\n![Table showing transistor count](figures/transistor-table.png){#id .class width=50% height=50%}\n\n</center>\n\n## Scraping\n\nThis chunk of code grabs the HTML of the Wikipedia page, selects all the tables on the page and saves the one we want to analyze as a tibble, a very handy dataframe alternative. Rvest's `html_table` function returns all of the elements of a web table, neat!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://en.wikipedia.org/wiki/Transistor_count\"\n\nhtml <- read_html(url)\n\nhtml_tables <- html %>% \n  html_table()\n\ndf_transistors <- html_tables[[4]]\n```\n:::\n\n\n## Data processing\n\nAs visible in the screen capture of the table above, a few cells also hyper-link to sources for the stats. These square brackets prevent R from reading the column as a set of numbers, instead the cell contents are returned as characters.\nIn the chunk below I use readr's `parse_number` function to extract the numbers from each cell and store them as a double.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_transistors <- df_transistors %>% \n  janitor::clean_names() %>% \n  mutate(processor = str_squish(str_remove(processor, \"\\\\(.*\"))) %>% \n  mutate_at(c(\"transistor_count\", \"date_ofintroduction\", \"process_nm\", \"area_mm2\"), parse_number)\n```\n:::\n\n\n## Data viz preparation\n\nIn this chunk I lump together the chip designers into the five largest groups and an 'other' category with forcats' `fct_lump` function. It returns these categories as factors. To make the graphic readable, I `sample` 50 of the processors from the table of 193 to annotate onto the plot I also store some graph labels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_transistors %>% \n  count(designer, sort = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 44 × 2\n   designer              n\n   <chr>             <int>\n 1 Intel                64\n 2 Apple                22\n 3 AMD                  21\n 4 IBM                  19\n 5 Fujitsu              10\n 6 Huawei                7\n 7 Motorola              7\n 8 Qualcomm              7\n 9 DEC                   5\n10 Texas Instruments     5\n# … with 34 more rows\n```\n:::\n\n```{.r .cell-code}\ndf_transistors <- df_transistors %>% \n  mutate(designer = fct_lump(designer, 5))\n\nprocessor_labels <- sample(df_transistors$processor, 50)\n\ntitle <- \"Moore's Law\"\n\nsubtitle <- \"The number of transistors on integrated circuit chips (1971-2020)\"\n\ncaption <- \"Source: Wikipedia - Transistor Count: https://en.wikipedia.org/wiki/Transistor_count\"\n```\n:::\n\n\n## Plotting \n\nHere I draw the graphic using ggplot2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# jpeg(\n#     filename=\"C:/Users/User/Documents/Recon/jjayes_distill/_posts/2021-04-21-chips/figures/Transistors_colour.jpeg\",\n#     width=6,\n#     height=4,\n#     units=\"in\",\n#     res=1000)\n\ndf_transistors %>% \n  ggplot(aes(date_ofintroduction, transistor_count)) +\n  geom_smooth(group = 1, alpha = .1) +\n  geom_point(aes(colour = designer, shape = designer), cex = 3) +\n  geom_text_repel(data = df_transistors %>% \n                    filter(processor %in% processor_labels), \n                  aes(date_ofintroduction, transistor_count, label = processor),\n                  cex = 3, colour = \"#505050\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_shape_manual(values = seq(15,20, by = 1)) +\n  scale_y_log10(labels = scales::comma_format()) +\n  labs(x = \"Year\",\n       y = \"Transistor Count (log scale)\",\n       shape = \"Chip Designer\",\n       colour = \"Chip Designer\",\n       caption = caption,\n       title = title,\n       subtitle = subtitle)\n```\n\n::: {.cell-output-display}\n![](chips_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n\n```{.r .cell-code}\n# dev.off()\n```\n:::\n\n\nI include a smoothed line of best fit (with `geom_smooth`) below the points to show how progression in transistor count has slowed since 2005, despite the number of chips designed each year increasing.\n\nI use `geom_text_repel` to prevent the labels overlapping each other, and put the y-axis on a log scale to draw attention to the approximate doubling of transistor count each year.\n\n## Conclusion\n\nThanks for reading along! I hope you learned some neat tricks, and see how easy it is to grab data from the web to visualize.\n\n",
    "supporting": [
      "chips_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}